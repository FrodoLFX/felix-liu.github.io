<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Felix Liu | Portfolio</title>
    <style>
        :root {
            /* DARK MODE (Default) */
            --bg-color: #050505;
            --card-bg: rgba(30, 30, 30, 0.6);
            --card-border: rgba(255, 255, 255, 0.1);
            --text-primary: #f5f5f7;
            --text-secondary: #86868b;
            --accent-blue: #2997ff;
            --accent-glow: rgba(41, 151, 255, 0.4);
            --nav-bg: rgba(20, 20, 20, 0.8);
            --btn-bg: #fff;
            --btn-text: #000;
            --shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        [data-theme="light"] {
            /* LIGHT MODE */
            --bg-color: #f2f2f7;
            --card-bg: rgba(255, 255, 255, 0.75);
            --card-border: rgba(0, 0, 0, 0.05);
            --text-primary: #1d1d1f;
            --text-secondary: #515154;
            --accent-blue: #0071e3;
            --accent-glow: rgba(0, 113, 227, 0.2);
            --nav-bg: rgba(255, 255, 255, 0.85);
            --btn-bg: #1d1d1f;
            --btn-text: #fff;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, sans-serif;
            overflow-x: hidden;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        /* --- THEME TOGGLE --- */
        #theme-toggle {
            position: fixed; top: 25px; right: 25px;
            z-index: 1001;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-primary);
            padding: 10px 18px;
            border-radius: 20px;
            cursor: pointer;
            backdrop-filter: blur(20px);
            font-weight: 600;
            transition: transform 0.2s;
        }
        #theme-toggle:hover { transform: scale(1.05); }

        /* --- NAVIGATION --- */
        nav {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 500px; height: 60px;
            background: var(--nav-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 50px;
            border: 1px solid var(--card-border);
            display: flex; justify-content: space-around; align-items: center;
            padding: 0 10px; z-index: 1000;
            box-shadow: var(--shadow);
            transition: background 0.5s;
        }

        .nav-item {
            color: var(--text-secondary);
            font-size: 0.9rem; font-weight: 500; cursor: pointer;
            padding: 8px 18px; border-radius: 30px;
            transition: all 0.3s ease;
        }
        .nav-item:hover { color: var(--text-primary); }
        .nav-item.active { 
            color: #fff; 
            background: var(--accent-blue); 
            box-shadow: 0 0 15px var(--accent-glow); 
        }

        /* --- LAYOUT STRUCTURE (Fixes rendering bug) --- */
        main {
            position: relative;
            width: 100%;
            min-height: 100vh;
            padding-top: 80px; /* Space for nav */
        }

        .section-container {
            display: none; /* Default hidden */
            width: 100%;
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px 100px 20px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .section-container.active {
            display: block;
            opacity: 1;
            animation: fadeUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        /* --- HERO (Special Case) --- */
        #hero-section {
            display: none;
            position: relative; 
            height: 90vh; /* Full viewport height minus a bit */
            width: 100%;
            flex-direction: column;
            justify-content: center; 
            align-items: center;
            overflow: hidden;
            margin-top: -80px; /* Counteract main padding for full screen look */
        }
        
        #hero-section.active { display: flex; opacity: 1; }

        canvas#hologram-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0;
        }

        .hero-content {
            z-index: 2; text-align: center; pointer-events: none;
        }

        h1 {
            font-size: 5rem; font-weight: 800; letter-spacing: -0.03em;
            background: linear-gradient(135deg, var(--text-primary) 30%, var(--text-secondary) 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            text-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .github-btn {
            pointer-events: auto;
            display: inline-block;
            margin-top: 30px;
            padding: 14px 35px;
            background: var(--btn-bg); color: var(--btn-text);
            text-decoration: none; font-weight: 600; border-radius: 30px;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .github-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--accent-glow);
        }

        /* --- BENTO GRID CARDS --- */
        .bento-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px; margin-top: 20px; perspective: 1000px;
        }

        .bento-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-radius: 28px; padding: 35px;
            box-shadow: var(--shadow);
            transform-style: preserve-3d;
            will-change: transform;
            transition: box-shadow 0.3s;
        }
        
        .bento-card h3 { font-size: 1.5rem; margin-bottom: 5px; color: var(--text-primary); }
        .bento-card h4 { font-size: 0.95rem; color: var(--accent-blue); margin-bottom: 15px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .bento-card p, .bento-card ul { color: var(--text-secondary); line-height: 1.6; font-size: 1rem; }
        .bento-card ul { padding-left: 20px; margin-top: 10px; }
        .bento-card li { margin-bottom: 8px; }
        .bento-wide { grid-column: 1 / -1; }

        /* --- GAME UI --- */
        #game-wrapper {
            position: relative; width: 100%; height: 500px;
            background: #000; border-radius: 28px;
            border: 2px solid var(--accent-blue); overflow: hidden;
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 0 40px var(--accent-glow);
        }
        canvas#game-canvas { display: block; background: #000; cursor: crosshair; }
        #game-ui {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; background: rgba(0,0,0,0.85); padding: 40px; border-radius: 20px;
            backdrop-filter: blur(10px); border: 1px solid var(--accent-blue); color: #fff;
            z-index: 10;
        }
        button.play-btn {
            background: var(--accent-blue); color: white; border: none;
            padding: 12px 30px; font-size: 1.1rem; border-radius: 30px;
            cursor: pointer; font-weight: 600; margin-top: 20px;
            transition: transform 0.2s;
        }
        button.play-btn:hover { transform: scale(1.1); box-shadow: 0 0 20px var(--accent-glow); }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

    </style>
</head>
<body data-theme="dark">

    <button id="theme-toggle" onclick="toggleTheme()">Light Mode</button>

    <nav>
        <div class="nav-item active" onclick="switchTab('home')">Home</div>
        <div class="nav-item" onclick="switchTab('work')">Work</div>
        <div class="nav-item" onclick="switchTab('projects')">Projects</div>
        <div class="nav-item" onclick="switchTab('game')">Game</div>
    </nav>

    <main>
        <section id="hero-section" class="active">
            <canvas id="hologram-canvas"></canvas>
            <div class="hero-content">
                <h1>Fangxin (Felix) Liu</h1>
                <p style="font-size: 1.5rem; color: var(--text-secondary);">System Integration & Firmware Engineer</p>
                <a href="https://github.com/FrodoLFX" target="_blank" class="github-btn">
                    Visit GitHub Profile
                </a>
            </div>
            <div class="bento-grid" style="width: 100%; max-width: 900px; margin-top: 60px; z-index: 2;">
                <div class="bento-card bento-wide" style="background: rgba(15,15,15,0.4); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.05);">
                    <h3 style="text-align: center; font-size: 1.2rem; color: #aaa;">About Me</h3>
                    <p style="text-align: center; margin-top: 10px;">
                        RPI Class of 2026. Specializing in embedded systems, FPGA, and high-performance computing. 
                        Bridging the gap between hardware and software.
                    </p>
                </div>
            </div>
        </section>

        <div id="work" class="section-container">
            <h2 style="text-align:center; font-size:3rem; margin-bottom:40px;">Experience</h2>
            <div class="bento-grid">
                <div class="bento-card bento-wide">
                    <h3>Tesla</h3>
                    <h4>System Integration Engineer Intern | Jun 2024 - Sep 2024</h4>
                    <ul>
                        <li>Executed 55+ system integration tests and 80+ microsecond-level e-fuse safety tests on Model Y.</li>
                        <li>Designed protections increasing safety rate by 50% in harsh environments.</li>
                        <li>Validated 358 subsystem parts configurations for low-voltage electronics.</li>
                        <li>Gathered 5000+ data sets for thermal modeling.</li>
                    </ul>
                </div>
                <div class="bento-card">
                    <h3>Tesla</h3>
                    <h4>Low Voltage Systems TPM Intern | Jan 2024 - May 2024</h4>
                    <ul>
                        <li>Led construction of 7 infotainment bucks for e-call validation.</li>
                        <li>Managed Solar Chamber project, improving sensor accuracy by 30%.</li>
                    </ul>
                </div>
                <div class="bento-card">
                    <h3>NYS Office of IT Services</h3>
                    <h4>Mainframe Development Intern | Feb 2023 - Dec 2023</h4>
                    <ul>
                        <li>Maintained 24/7 Mainframe System serving New York State.</li>
                        <li>Remediated 200+ deprecated system routines.</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="projects" class="section-container">
            <h2 style="text-align:center; font-size:3rem; margin-bottom:40px;">Projects & Research</h2>
            <div class="bento-grid">
                <div class="bento-card bento-wide">
                    <h3>RPI ECSE Department</h3>
                    <h4>Research Assistant | Sep 2025 - Current</h4>
                    <ul>
                        <li>Researching GPU customized operation using C++ with CUDA and CUTLASS.</li>
                        <li>Accelerated Computation using Python with PyTorch.</li>
                    </ul>
                </div>
                <div class="bento-card">
                    <h3>FPGA Processor</h3>
                    <h4>System Verilog</h4>
                    <p>Designed a 5-stage Pipeline RISC-V Processor supporting assembly programs.</p>
                </div>
                <div class="bento-card">
                    <h3>Robotic Car</h3>
                    <h4>Embedded C / TI MSP432</h4>
                    <p>Built a robotic car with autonomous navigation logic and motion sensing joystick.</p>
                </div>
                <div class="bento-card">
                    <h3>IBM z/OS Open Source</h3>
                    <h4>Mainframe Utility</h4>
                    <p>Contributed to z/OS open-source development modernizing mainframe utilities.</p>
                </div>
            </div>
        </div>

        <div id="game" class="section-container">
            <h2 style="text-align:center; margin-bottom:20px;">Packet Defender</h2>
            <div id="game-wrapper">
                <div id="game-ui">
                    <h2>System Security Breach</h2>
                    <p style="margin: 20px 0; color: #ccc;">Click to Shoot. Move Mouse to Aim.</p>
                    <button class="play-btn" onclick="initGame()">START DEFENSE</button>
                </div>
                <canvas id="game-canvas"></canvas>
            </div>
        </div>
    </main>

    <script>
        // --- TAB SWITCHING (FIXED LAYOUT BUG) ---
        function switchTab(id) {
            window.scrollTo(0,0); // Force scroll reset to prevent empty space
            
            // 1. Update Nav
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            const activeBtn = Array.from(document.querySelectorAll('.nav-item'))
                                   .find(el => el.getAttribute('onclick').includes(id));
            if(activeBtn) activeBtn.classList.add('active');

            // 2. Hide Everything First
            document.getElementById('hero-section').classList.remove('active');
            document.querySelectorAll('.section-container').forEach(el => {
                el.classList.remove('active');
            });

            // 3. Show Target
            if (id === 'home') {
                document.getElementById('hero-section').classList.add('active');
            } else {
                const target = document.getElementById(id);
                target.classList.add('active');
            }

            // 4. Handle Game State
            if(id === 'game') resizeGame();
            else gameRunning = false;
        }

        // --- THEME TOGGLE ---
        function toggleTheme() {
            const body = document.body;
            const btn = document.getElementById('theme-toggle');
            if(body.getAttribute('data-theme') === 'dark') {
                body.setAttribute('data-theme', 'light');
                btn.innerText = "Dark Mode";
            } else {
                body.setAttribute('data-theme', 'dark');
                btn.innerText = "Light Mode";
            }
        }

        // --- IMPROVED HOLOGRAM (Slow + Fog + Light Mode) ---
        const hCanvas = document.getElementById('hologram-canvas');
        const hCtx = hCanvas.getContext('2d');
        let hWidth, hHeight;
        let particles = [];
        
        // Physics variables
        let targetRotX = 0, targetRotY = 0;
        let currentRotX = 0, currentRotY = 0;

        function resizeHologram() {
            hWidth = hCanvas.width = window.innerWidth;
            hHeight = hCanvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeHologram);

        // MOUSE MOVE: Extremely Low Sensitivity
        window.addEventListener('mousemove', e => {
            // Mapping mouse position to a small rotation angle
            // Factor 0.00005 is VERY slow
            targetRotX = (e.clientX - hWidth/2) * 0.00005; 
            targetRotY = (e.clientY - hHeight/2) * 0.00005;
        });

        class Star {
            constructor(isFog) {
                this.isFog = isFog;
                const r = isFog ? (Math.random() * 800 + 200) : (Math.random() * 800 + 400); // Radius
                const theta = Math.random() * 2 * Math.PI;
                const phi = Math.acos((Math.random() * 2) - 1);

                this.x = r * Math.sin(phi) * Math.cos(theta);
                this.y = r * Math.sin(phi) * Math.sin(theta);
                this.z = r * Math.cos(phi);
                
                this.size = isFog ? Math.random() * 1.5 : Math.random() * 2.5 + 1;
                this.baseAlpha = Math.random();
            }

            update() {
                // Smooth Lerp (Linear Interpolation) for lazy movement
                currentRotX += (targetRotX - currentRotX) * 0.02; 
                currentRotY += (targetRotY - currentRotY) * 0.02;

                const cosY = Math.cos(currentRotX);
                const sinY = Math.sin(currentRotX);
                const cosX = Math.cos(currentRotY);
                const sinX = Math.sin(currentRotY);

                // Rotate Y
                let dx = this.x * cosY - this.z * sinY;
                let dz = this.z * cosY + this.x * sinY;
                this.x = dx; this.z = dz;

                // Rotate X
                let dy = this.y * cosX - this.z * sinX;
                dz = this.z * cosX + this.y * sinX;
                this.y = dy; this.z = dz;
            }

            draw() {
                let fov = 800;
                let scale = fov / (fov + this.z);
                if (scale < 0) return;

                let x2d = hWidth/2 + this.x * scale;
                let y2d = hHeight/2 + this.y * scale;

                const isLight = document.body.getAttribute('data-theme') === 'light';
                
                // Color Logic
                if (isLight) {
                    // In Light Mode: Stars are black/dark grey, Fog is deep blue
                    if(this.isFog) hCtx.fillStyle = `rgba(0, 50, 100, ${this.baseAlpha * 0.3})`;
                    else hCtx.fillStyle = `rgba(10, 10, 20, ${this.baseAlpha})`;
                } else {
                    // In Dark Mode: Stars white, Fog is faint blue
                    if(this.isFog) hCtx.fillStyle = `rgba(100, 150, 255, ${this.baseAlpha * 0.2})`;
                    else hCtx.fillStyle = `rgba(255, 255, 255, ${this.baseAlpha})`;
                }

                hCtx.beginPath();
                hCtx.arc(x2d, y2d, this.size * scale, 0, Math.PI * 2);
                hCtx.fill();
            }
        }

        function initHologram() {
            resizeHologram();
            particles = [];
            // 400 Main Stars
            for(let i=0; i<400; i++) particles.push(new Star(false));
            // 600 Fog Particles
            for(let i=0; i<600; i++) particles.push(new Star(true));
            animateHologram();
        }

        function animateHologram() {
            hCtx.clearRect(0,0, hWidth, hHeight);
            
            // Draw Supernova Glow (Center)
            const isLight = document.body.getAttribute('data-theme') === 'light';
            const grad = hCtx.createRadialGradient(hWidth/2, hHeight/2, 10, hWidth/2, hHeight/2, 500);
            
            if(isLight) {
                grad.addColorStop(0, 'rgba(0, 0, 0, 0.1)'); // Dark center for light mode
                grad.addColorStop(1, 'rgba(0,0,0,0)');
            } else {
                grad.addColorStop(0, 'rgba(41, 151, 255, 0.2)');
                grad.addColorStop(1, 'rgba(0,0,0,0)');
            }
            
            hCtx.fillStyle = grad;
            hCtx.fillRect(0,0, hWidth, hHeight);

            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animateHologram);
        }
        initHologram();


        // --- 3D TILT CARDS (Projecting Shadows) ---
        const cards = document.querySelectorAll('.bento-card');
        cards.forEach(card => {
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                // Tilt logic
                const rotateX = ((y - centerY) / centerY) * -8;
                const rotateY = ((x - centerX) / centerX) * 8;
                
                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
            });
            card.addEventListener('mouseleave', () => {
                card.style.transform = `perspective(1000px) rotateX(0) rotateY(0) scale(1)`;
            });
        });

        // --- GAME LOGIC ---
        const gCanvas = document.getElementById('game-canvas');
        const gCtx = gCanvas.getContext('2d');
        let gameRunning = false;
        let player = { x: 0, y: 0, s: 30 };
        let projectiles = [];
        let enemies = [];
        let score = 0;
        let frame = 0;

        function resizeGame() {
            const wrapper = document.getElementById('game-wrapper');
            gCanvas.width = wrapper.clientWidth;
            gCanvas.height = wrapper.clientHeight;
            player.y = gCanvas.height - 50;
        }
        window.addEventListener('resize', resizeGame);

        gCanvas.addEventListener('mousemove', e => {
            const rect = gCanvas.getBoundingClientRect();
            player.x = e.clientX - rect.left - player.s/2;
        });

        gCanvas.addEventListener('mousedown', () => {
            if(gameRunning) projectiles.push({x: player.x + player.s/2, y: player.y, r: 4});
        });

        function initGame() {
            document.getElementById('game-ui').style.display = 'none';
            resizeGame();
            projectiles = []; enemies = []; score = 0; frame = 0;
            gameRunning = true;
            gameLoop();
        }

        function gameLoop() {
            if(!gameRunning) return;
            frame++;
            gCtx.clearRect(0, 0, gCanvas.width, gCanvas.height);

            // Player
            gCtx.fillStyle = '#2997ff';
            gCtx.fillRect(player.x, player.y, player.s, player.s);

            // Projectiles
            gCtx.fillStyle = '#fff';
            projectiles.forEach((p, i) => {
                p.y -= 10;
                gCtx.beginPath(); gCtx.arc(p.x, p.y, p.r, 0, Math.PI*2); gCtx.fill();
                if(p.y < 0) projectiles.splice(i, 1);
            });

            // Enemies
            if(frame % 50 === 0) enemies.push({x: Math.random()*(gCanvas.width-30), y: -30});
            
            enemies.forEach((e, i) => {
                e.y += 2;
                gCtx.fillStyle = '#ff3b30';
                gCtx.fillRect(e.x, e.y, 30, 30);
                
                // Collision
                projectiles.forEach((p, pi) => {
                    if(p.x > e.x && p.x < e.x + 30 && p.y > e.y && p.y < e.y + 30) {
                        enemies.splice(i, 1); projectiles.splice(pi, 1);
                        score += 10;
                    }
                });

                if(e.y > gCanvas.height) {
                    gameRunning = false;
                    document.getElementById('game-ui').style.display = 'block';
                    document.querySelector('#game-ui h2').innerText = "SCORE: " + score;
                }
            });

            gCtx.fillStyle = '#fff';
            gCtx.font = "20px Arial";
            gCtx.fillText("Score: " + score, 20, 30);
            requestAnimationFrame(gameLoop);
        }
    </script>
</body>
</html>
